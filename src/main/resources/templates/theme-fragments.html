<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns="http://www.w3.org/1999/html">
<!-- csrf 토큰 오류 해결 방법 -->
<!--<meta name="_csrf" th:content="${_csrf.token}">
<meta name="_csrf_header" th:content="${_csrf.headerName}">-->
<style th:fragment="search_form">
    .container-1{
        width: 250px;
        vertical-align: middle;
        white-space: nowrap;
        position: relative;
    }

    .container-1 input#search::-webkit-input-placeholder {
        color: #65737e;
    }

    .container-1 input#search:-moz-placeholder { /* Firefox 18- */
        color: #65737e;
    }

    .container-1 input#search::-moz-placeholder {  /* Firefox 19+ */
        color: #65737e;
    }

    .container-1 input#search:-ms-input-placeholder {
        color: #65737e;
    }

    .container-1 .icon{
        position: absolute;
        top: 50%;
        margin-left: 17px;
        margin-top: 17px;
        z-index: 1;
        color: #4f5b66;
    }

    .container-1 input#search:hover, .container-1 input#search:focus, .container-1 input#search:active{
        outline:none;
        background: #ffffff;
    }

    .container-1 input#search{
        width: 250px;
        height: 50px;
        background: #d3d3d3;
        border: none;
        font-size: 10pt;
        float: left;
        padding-left: 45px;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;


        -webkit-transition: background .55s ease;
        -moz-transition: background .55s ease;
        -ms-transition: background .55s ease;
        -o-transition: background .55s ease;
        transition: background .55s ease;
    }
</style>
<head th:fragment="head">
    <style>
        #loadingSpin {
            position: absolute;
            top: 500%;
            left: 45%;
            z-index: 100;
            width: 3rem;
            height: 3rem;
        }

        .custom-file label {
            color: white;
            cursor: pointer;
        }

        .custom-file input[type="file"] {  /* 파일 필드 숨기기 */
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip:rect(0,0,0,0);
            border: 0;
        }
        .tagify-outside{
            border: 0;
            padding: 0;
            margin: 0;
        }

        /* 툴팁 기본 스타일 설정 시작 */

        .tooltip {
            position: relative;
            display: block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 100px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            font-size: 12px;
            position: absolute;
            z-index: 1;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }

        /* 툴팁 기본 스타일 설정 끝 */

        /* -------------------------- */

        /* 툴팁 화살표 기본 스타일 설정 시작 */

        .tooltip .tooltiptext::after {
            content: " ";
            position: absolute;
            border-style: solid;
            border-width: 5px;
        }

        /* 툴팁 화살표 기본 스타일 설정 끝 */


        /* 툴팁 화살표 기본 스타일 설정 시작 */

        .tooltip .tooltiptext::after {
            content: " ";
            position: absolute;
            border-style: solid;
            border-width: 5px;
        }

        /* 툴팁 화살표 기본 스타일 설정 끝 */

        /* -------------------------- */

        /* 툴팁 방향 설정 시작 */

        /* 왼쪽 툴팁 시작 */

        .tooltip .tooltip-left {
            top: -5px;
            right: 105%;
        }

        .tooltip .tooltip-left::after {
            top: 50%;
            left: 100%;
            margin-top: -5px;
            border-color: transparent transparent transparent black;
        }

        /* 왼쪽 툴팁 끝 */

        /* 오른쪽 툴팁 시작 */

        .tooltip .tooltip-right {
            top: -5px;
            left: 105%;
        }

        .tooltip .tooltip-right::after {
            top: 50%;
            right: 100%;
            margin-top: -5px;
            border-color: transparent black transparent transparent;
        }

        /* 오른쪽 툴팁 끝 */

        /* 위쪽 툴팁 시작 */

        .tooltip .tooltip-top {
            width: 120px;
            bottom: 150%;
            left: 50%;
            margin-left: -60px;
        }

        .tooltip .tooltip-top::after {
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-color: black transparent transparent transparent;
        }

        /* 아래쪽 툴팁 시작 */

        .tooltip .tooltip-bottom {
            width: 120px;
            top: 150%;
            left: 50%;
            margin-left: -60px;
        }


        .tooltip .tooltip-bottom::after {
            bottom: 100%;
            left: 50%;
            margin-left: -5px;
            border-color: transparent transparent black transparent;
        }

        #update-banner:hover, button:hover{
            color: rgba(59, 130, 246, 0.5);
        }

        /* 아래쪽 툴팁 시작 */

        /* 아래쪽 툴팁 끝 */
    </style>

    <!-- theme header
    ================================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" />
    <!-- Favicon -->
    <link href="/assets/images/favicon.png" rel="icon" type="image/png">
    <!-- Basic Page Needs
        ================================================== -->
    <title>unect</title>
    <meta name="description" content="Socialite is - Professional A unique and beautiful collection of UI elements">
    <!-- icons
    ================================================== -->
    <link rel="stylesheet" href="/assets/css/icons.css">
    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="/assets/css/uikit.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <!-- Javascript
    ================================================== -->
    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/node_modules/identicon.js/identicon.js"></script>
    <script src="/assets/js/tippy.all.min.js"></script>
    <script src="/assets/js/uikit.js"></script>
    <script src="/assets/js/simplebar.js"></script>
    <script src="/assets/js/custom.js"></script>
    <script src="/assets/js/bootstrap-select.min.js"></script>
    <script src="/assets/js/for-nightmode.js"></script>
    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>
    <script th:inline="javascript">
        $(document).ready(function () {
            function isBrowserCheck(){
                const agt = navigator.userAgent.toLowerCase();
                if (agt.indexOf("chrome") != -1 || agt.indexOf("crios") != -1) return 'Chrome'
                if (agt.indexOf("opera") != -1) return 'Opera'
                if (agt.indexOf("staroffice") != -1) return 'Star Office'
                if (agt.indexOf("webtv") != -1) return 'WebTV'
                if (agt.indexOf("beonex") != -1) return 'Beonex'
                if (agt.indexOf("chimera") != -1) return 'Chimera'
                if (agt.indexOf("netpositive") != -1) return 'NetPositive'
                if (agt.indexOf("phoenix") != -1) return 'Phoenix'
                if (agt.indexOf("firefox") != -1) return 'Firefox'
                if (agt.indexOf("safari") != -1) return 'Safari'
                if (agt.indexOf("skipstone") != -1) return 'SkipStone'
                if (agt.indexOf("netscape") != -1) return 'Netscape'
                if (agt.indexOf("mozilla/5.0") != -1) return 'Mozilla'
                if (agt.indexOf("msie") != -1) {
                    let rv = -1;
                    if (navigator.appName == 'Microsoft Internet Explorer') {
                        let ua = navigator.userAgent;
                        var re = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
                        if (re.exec(ua) != null)
                            rv = parseFloat(RegExp.$1)
                    }
                    return 'Internet Explorer '+rv
                }
            }
            const browser = isBrowserCheck()
            console.log(browser)
            if(browser !== 'Chrome' && browser !== 'Safari'){
                alert('크롬 브라우저 및 Safari 외에는 지원되지 않습니다.');
                /*var openNewWindow = window.open("about:blank");
                openNewWindow.location.href = "https://www.google.co.kr/intl/ko/chrome/";*/
                location.href="https://www.google.co.kr/intl/ko/chrome/"
            }
            $(".identicon").each(function() {
                var hash = md5($(this).data('id')).toString();
                var data = new Identicon(hash,{format:'svg'}).toString();
                $(this).attr('src', "data:image/svg+xml;base64,"+data);
            });

            $('#loadingSpin').hide();

            $(document).on('click', '#search_btn', function() {
                if ($("select[name=searchType]").val() == "") {
                    swal("검색 구분을 입력해주세요.", "검색창 좌측에 있는 화살표를 눌러서 검색 구분을 선택해주세요.");
                    return false;
                }
                if ($("input[name=keyword]").val() == "") {
                    swal("검색어를 입력해주세요.", "검색창에 검색어를 입력해주세요!");
                    return false;
                }
            });
        });

        function alarmChecked() {
            $.ajax({
                url: '/alarm/allChecked',
                type: 'GET',
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                success: function (message) {
                    $('.refresh_alarm').load(location.href+' .refresh_alarm');
                    $('.refresh_alarm_count').load(location.href+' .refresh_alarm_count');
                    $('.alarm-main-view').load(location.href+' .alarm-main-view');
                    swal("모든 알림이 체크됐습니다.", {
                        icon: "success",
                    });
                },
                error: function () {
                    swal("읽을 알람이 존재하지 않습니다.", {
                        icon: "error",
                    });
                }
            })
        }
        function chatChecked() {
            $.ajax({
                url: '/chat/allReadChk',
                type: 'GET',
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                success: function (message) {
                    $('.refresh_chat').load(location.href+' .refresh_chat');
                    $('.refresh_chat_count').load(location.href+' .refresh_chat_count');
                    swal("모든 쪽지를 읽었습니다.", {
                        icon: "success",
                    });
                },
                error: function () {
                    swal("읽을 쪽지가 존재하지 않습니다.", {
                        icon: "error",
                    });
                }
            })
        }
    </script>

    <script src='//cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.7.0/js/md5.min.js'></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/identicon.js/2.3.3/identicon.min.js"></script>

    <!-- 기존에서 불러온 것
    ================================================== -->
    <!-- script -->

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="/node_modules/@yaireo/tagify/dist/tagify.min.js"></script>
    <script src="/node_modules/summernote/dist/summernote-bs4.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.4/dist/js/foundation.min.js" crossorigin="anonymous"></script>

    <!-- css -->
    <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.4/dist/css/foundation.min.css" crossorigin="anonymous">-->
    <link rel="stylesheet" href="/node_modules/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/node_modules/@yaireo/tagify/dist/tagify.css">
    <link rel="stylesheet" href="/node_modules/summernote/dist/summernote-bs4.min.css">
    <link  href="/node_modules/cropper/dist/cropper.min.css" rel="stylesheet">

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</head>


<!-- Header -->
<header th:fragment="header" id="header_frag">
    <div id="loadingSpin">
        <div style="border-top-color:transparent" class="w-16 h-16 border-4 border-blue-400 border-solid rounded-full animate-spin"></div>
    </div>
    <div class="bg-white py-4 shadow dark:bg-gray-800" sec:authorize="!isAuthenticated()">
        <style>
            input , .bootstrap-select.btn-group button {
                background-color: #f3f4f6 !important;
                height: 44px !important;
                box-shadow: none !important;
            }
            form{
                margin-top: 100px;
            }
        </style>
        <div class="max-w-6xl mx-auto">

            <!--<link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.css" />-->
            <div class="flex items-center lg:justify-between justify-around">
                <a th:href="@{/}">
                    <img  alt="" class="w-32">
                </a>
                <div class="capitalize flex font-semibold  my-2 space-x-3 text-center text-sm">
                    <a th:href="@{/login}" class="py-3 px-4">로그인</a>
                    <a th:href="@{/sign-up}" class="bg-purple-500 purple-500 px-6 py-3 rounded-md shadow text-white">회원가입</a>
                </div>
            </div>
        </div>
    </div>
    <div class="header_wrap" sec:authorize="isAuthenticated()">
        <div class="header_inner mcontainer">
            <div class="left_side">
                    <span class="slide_menu" uk-toggle="target: #wrapper ; cls: is-collapse is-active">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                            <path d="M3 4h18v2H3V4zm0 7h12v2H3v-2zm0 7h18v2H3v-2z" fill="currentColor"></path>
                        </svg>
                    </span>
                <div id="logo">
                    <a href="/">
                        <img src="/assets/images/logo.png" alt="">
                        <img src="/assets/images/logo-mobile.png" class="logo_mobile" alt="">
                    </a>
                </div>
            </div>

            <!-- search icon for mobile -->
            <div class="header-search-icon" uk-toggle="target: #wrapper ; cls: show-searchbox"> </div>
            <div class="header_search">
                <form id="searchForm" th:action="@{/search/lists}" method="post">
                    <div class="flex items-center">
                        <select class="w-4 h-4 fill-current text-blue-500 ml-4 z-10 bg-gray-200" name="searchType">
                            <option value="" selected>검색 분류를 선택해주세요.</option>
                            <option value="스터디">스터디</option>
                            <option value="커뮤니티">커뮤니티</option>
                            <option value="장터">장터</option>
                            <option value="학생회">학생회 공지 및 행사</option>
                        </select>
                        <input type='text' placeholder="검색어를 입력해주세요." name="keyword" autocomplete="off"
                               class="w-full -ml-8 pl-10 px-4 py-2 border rounded-lg text-gray-700 focus:outline-none focus:border-green-500"/>
                        <button type="submit" id="search_btn">
                            <svg class="w-4 h-4 fill-current text-blue-500 -ml-8 z-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                        </button>
                    </div>
                </form>
            </div>


            <div class="right_side">

                <div class="header_widgets">

                    <a href="#" class="is_icon" uk-tooltip="title: 알림">
                        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"></path></svg>
                        <div class="refresh_alarm_count">
                            <th:block th:if="${g_countByAccountAndNotChecked <= 9}">
                                <span th:text="${g_countByAccountAndNotChecked}" class="pt-1">3</span>
                            </th:block>
                            <th:block th:if="${g_countByAccountAndNotChecked > 9}">
                                <span class="pt-1">9+</span>
                            </th:block>
                        </div>
                    </a>
                    <div uk-drop="mode: click" class="header_dropdown ">
                        <div  class="dropdown_scrollbar">
                            <div class="drop_headline">
                                <h4>알림 </h4>
                                <div class="btn_action">
                                    <a href="#" th:href="@{/profile/settings/alarm}" data-tippy-placement="left" title="설정">
                                        <ion-icon name="settings-outline"></ion-icon>
                                    </a>
                                    <a onclick="alarmChecked()" data-tippy-placement="left" title="모두 읽기">
                                        <ion-icon name="checkbox-outline"></ion-icon>
                                    </a>
                                </div>
                            </div>
                            <div>
                                <ul>
                                    <div class="refresh_alarm">
                                        <li th:each="alarm : ${g_accountAlarmNotChecked}">
                                            <a th:href="@{'/alarm/detail/' + ${alarm.alarmId}}">
                                                <div class="drop_avatar">
                                                    <img th:if="${#strings.isEmpty(alarm.fromAccount.profileImage)}"
                                                         th:data-id="${alarm.fromAccount.studentId}"
                                                         alt="" class="identicon user_avatar" style="width: 45px; height: 45px;"/>
                                                    <img th:if="${!#strings.isEmpty(alarm.fromAccount.profileImage)}"
                                                         th:src="${alarm.fromAccount.profileImage}"
                                                         alt="" class=" shadow user_avatar" style="width: 45px; height: 45px;"/>
                                                </div>
                                                <span th:if="${alarm.alarmType.equals(alarm.alarmType.LIKES)}" class="drop_icon bg-gradient-primary">
                                                 <i class="icon-feather-thumbs-up"></i>
                                            </span>
                                                <div class="drop_text">
                                                    <p>
                                                        <strong th:text="${alarm.fromAccount.nickname}"> ezhoon </strong>
                                                        <span th:if="${alarm.alarmType.equals(alarm.alarmType.LIKES)}">님이 회원님의 글을 좋아합니다.</span>
                                                        <span th:if="${alarm.alarmType.equals(alarm.alarmType.BOARD_REPLY)}">님의 게시글에 댓글이 달렸습니다.</span>
                                                        <span th:if="${alarm.alarmType.equals(alarm.alarmType.MEETING_REPLY)}">님이 모임글에 댓글이 달렸습니다.</span>
                                                        <span th:if="${alarm.alarmType.equals(alarm.alarmType.MEETING)}">님의 스터디에 모임이 생성됐습니다.</span>
                                                        <span th:if="${alarm.alarmType.equals(alarm.alarmType.STUDY)}">님의 관심사에 해당하는 스터디가 생성됐습니다.</span>
                                                        <br>
                                                        <span th:text="${alarm.message}" class="text-link">게시물 제목 </span>
                                                    </p>
                                                    <time th:text="${account.dateTime(alarm.createAlarmTime)}"> 2시간 전 </time>
                                                </div>
                                            </a>
                                        </li>
                                        <div th:if="${g_countByAccountAndNotChecked > 4}"
                                             class="flex justify-center">
                                            <span class="font-bold" th:text="${g_countByAccountAndNotChecked} - 3"></span> 개의 알림이 더 있습니다.
                                        </div>
                                        <div class="flex justify-center">
                                            <a th:href="@{/alarm/view}"
                                               class="bg-white text-center font-semibold my-3 px-6 py-2 rounded-full shadow-md dark:bg-gray-800 dark:text-white">
                                                전체 보기
                                            </a>
                                        </div>
                                    </div>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Message -->
                    <a href="#" class="is_icon" uk-tooltip="title: 쪽지">
                        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"></path></svg>
                        <div class="refresh_chat_count">
                            <th:block th:if="${g_chatNotify.size() <= 9}">
                                <span class="pt-1" th:text="${g_chatNotify.size()}"></span>
                            </th:block>
                            <th:block th:if="${g_chatNotify.size() > 9}">
                                <span class="pt-1">9+</span>
                            </th:block>
                        </div>
                    </a>
                    <div uk-drop="mode: click" class="header_dropdown is_message">
                        <div  class="dropdown_scrollbar">
                            <div class="drop_headline">
                                <h4> 쪽지 </h4>
                                <div class="btn_action">
                                    <a onclick="chatChecked()" data-tippy-placement="left" title="모두 읽음">
                                        <ion-icon name="checkbox-outline"></ion-icon>
                                    </a>
                                </div>
                            </div>
                            <!--<input type="text" class="uk-input" placeholder="쪽지를 검색해보세요.">-->
                            <ul>
                                <div class="refresh_chat">
                                    <th:block th:each="myRoom : ${g_myRoom}">
                                        <th:block th:if="${!myRoom.getChatList().get(myRoom.getChatList().size()-1).getReadChk()}">
                                            <th:block th:if="${!myRoom.getChatList().get(myRoom.getChatList().size()-1).getSender().getNickname().equals(account.getNickname())}">
                                                <li class="un-read">
                                                    <a th:href="@{/chat/lists}">
                                                        <div class="drop_avatar">
                                                            <th:block th:if="${myRoom.getRoomHost().getNickname().equals(account.getNickname())}">
                                                                <img th:if="${#strings.isEmpty(myRoom.getRoomAttender()?.profileImage)}"
                                                                     th:data-id="${myRoom.getRoomAttender().studentId}"
                                                                     class="identicon jdenticon_fix"
                                                                     style="width: 45px; height: 45px;"
                                                                     alt=""/>
                                                                <img th:if="${!#strings.isEmpty(myRoom.getRoomAttender()?.profileImage)}"
                                                                     th:src="${myRoom.getRoomAttender()?.profileImage}"
                                                                     style="width: 45px; height: 45px;"
                                                                     alt=""/>
                                                            </th:block>
                                                            <th:block th:if="${myRoom.getRoomAttender().getNickname().equals(account.getNickname())}">
                                                                <img th:if="${#strings.isEmpty(myRoom.getRoomHost()?.profileImage)}"
                                                                     th:data-id="${myRoom.getRoomHost().studentId}"
                                                                     class="identicon jdenticon_fix"
                                                                     style="width: 45px; height: 45px;"
                                                                     alt=""/>
                                                                <img th:if="${!#strings.isEmpty(myRoom.getRoomHost()?.profileImage)}"
                                                                     th:src="${myRoom.getRoomHost()?.profileImage}"
                                                                     style="width: 45px; height: 45px;"
                                                                     alt=""/>
                                                            </th:block>
                                                        </div>
                                                        <div class="drop_text">
                                                            <th:block th:if="${myRoom.getRoomAttender().getNickname().equals(account.getNickname())}">
                                                                <strong th:text="${myRoom.getRoomHost().getNickname()}"> 닉네임 </strong><span class="font-bold" style="color: #4761FF" th:text="| (${g_chatService.unReadCount(myRoom)})|"> (2)</span>
                                                            </th:block>
                                                            <th:block th:if="${myRoom.getRoomHost().getNickname().equals(account.getNickname())}">
                                                                <strong th:text="${myRoom.getRoomAttender().getNickname()}"> 닉네임 </strong><span class="font-bold" style="color: #4761FF" th:text="| (${g_chatService.unReadCount(myRoom)})|"> (2)</span>
                                                            </th:block>
                                                            <time th:text="${account.dateTime(myRoom.getLastSendTime())}">시간</time><br>
                                                            <p th:text="${myRoom.getLastSendMsg()}">마지막 대화</p>
                                                        </div>
                                                    </a>
                                                </li>
                                            </th:block>
                                        </th:block>
                                    </th:block>
                                </div>
                            </ul>
                        </div>
                        <div class="flex justify-center">
                            <a th:href="@{/chat/lists}"
                               class="bg-white text-center font-semibold my-3 px-6 py-2 rounded-full shadow-md dark:bg-gray-800 dark:text-white">
                                전체 보기
                            </a>
                        </div>
                    </div>


                    <a href="#" sec:authorize="isAuthenticated()">

                        <img th:if="${#strings.isEmpty(account?.profileImage)}"
                             th:data-id="${account.studentId}"
                             width="24" height="24" class="identicon is_avatar"/>
                        <img th:if="${!#strings.isEmpty(account?.profileImage)}" th:src="${account.profileImage}"
                             width="24" height="24" class="is_avatar"/>
                    </a>
                    <div uk-drop="mode: click;offset:4" class="header_dropdown profile_dropdown">

                        <a href="#" th:href="@{'/profile/' + ${account.nickname} + '/view'}" class="user">
                            <div class="user_avatar">
                                <img th:if="${#strings.isEmpty(account?.profileImage)}"
                                     class="identicon user_avatar jdenticon_fix" style="object-fit: cover"
                                     th:data-id="${account.studentId}"/>
                                <img th:if="${!#strings.isEmpty(account?.profileImage)}" class="user_avatar"
                                     th:src="${account.profileImage}"/>
                            </div>
                            <div class="user_name">
                                <div class="user_name">
                                    <div th:text="${account.nickname}">유저이름</div>
                                    <span th:text="${account.studentId}">유저 학번</span>
                                </div>
                            </div>
                        </a>
                        <hr>
                        <a th:href="@{/profile/settings/profile-settings}">
                            <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path></svg>
                            설정
                        </a>
                        <hr>
                        <a href="#" id="night-mode" class="btn-night-mode">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
                            </svg>
                            다크 모드
                            <span class="btn-night-mode-switch">
                                <span class="uk-switch-button"></span>
                            </span>
                        </a>
                        <form action="#" name="logout" th:action="@{/logout}" method="post">
                            <a href="javascript:logout.submit();">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                    </path>
                                </svg>
                                로그아웃
                            </a>
                        </form>
                    </div>

                </div>

            </div>
        </div>
    </div>
</header>

<!-- sidebar -->
<div th:fragment="side_bar" class="sidebar">
    <div class="sidebar_inner">
        <ul>
            <li th:classappend="${currentSideMenu == 'study'}? active"><a th:href="@{/study}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z" />
                </svg><span> 스터디 </span></a>
            </li>
            <li th:classappend="${currentSideMenu == 'board'}? active"><a th:href="@{/board/free}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path fill-rule="evenodd" d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z" clip-rule="evenodd" />
                    <path d="M15 7h1a2 2 0 012 2v5.5a1.5 1.5 0 01-3 0V7z" />
                </svg>
                <span> 커뮤니티 </span></a>
            </li>
            <li th:classappend="${currentSideMenu == 'market'}? active"><a th:href="@{/market/sell}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd" />
                    <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z" />
                </svg> <span> 장터 </span> </a>
            </li>
            <li th:classappend="${currentSideMenu == 'council'}? active"><a th:href="@{/council/notice}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"></path>
                    <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"></path>
                </svg>
                <span> 학생회</span> </a>
            </li>
            <li th:classappend="${currentSideMenu == 'bookmark'}? active"><a th:href="@{/bookmarks}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z" clip-rule="evenodd"></path>
                </svg>
                <span> 북마크 </span> </a>
            </li>
            <li th:classappend="${currentSideMenu == 'graduation'}? active"><a th:href="@{/graduation}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-blue-500">
                    <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
                </svg>
                <span> 졸업작품 </span> </a>
            </li>
        </ul>

        <ul class="side_links">
            <li>
                <a th:href="@{/info/about}">
                    <ion-icon name="people-outline" class="side-icon"></ion-icon>
                    <span>소개</span>
                </a>
            </li>
            <li>
                <a th:href="@{/info/contact}">
                    <ion-icon name="mail-outline" class="side-icon"></ion-icon>
                    <span>건의사항</span>
                </a>
            </li>
            <li>
                <a th:href="@{/info/privacy}">
                    <ion-icon name="document-text-outline" class="side-icon"></ion-icon>
                    <span>서비스 약관</span>
                </a>
            </li>

        </ul>

    </div>



    <!-- sidebar overly for mobile -->
    <div class="side_overly" uk-toggle="target: #wrapper ; cls: is-collapse is-active"></div>

    <!-- For Night mode -->
    <script>
        (function (window, document, undefined) {
            'use strict';
            if (!('localStorage' in window)) return;
            var nightMode = localStorage.getItem('gmtNightMode');
            if (nightMode) {
                document.documentElement.className += ' night-mode';
            }
        })(window, document);

        (function (window, document, undefined) {

            'use strict';

            // Feature test
            if (!('localStorage' in window)) return;

            // Get our newly insert toggle
            var nightMode = document.querySelector('#night-mode');
            if (!nightMode) return;

            // When clicked, toggle night mode on or off
            nightMode.addEventListener('click', function (event) {
                event.preventDefault();
                document.documentElement.classList.toggle('dark');
                if (document.documentElement.classList.contains('dark')) {
                    localStorage.setItem('gmtNightMode', true);
                    return;
                }
                localStorage.removeItem('gmtNightMode');
            }, false);

        })(window, document);
    </script>
</div>

<div th:fragment="checked-email">
    <div class="alert alert-warning" role="alert" th:if="${account != null && !account.emailVerified}">
        <a href="#" th:href="@{/check-email}" class="alert-link">unect 가입을 완료해주세요. </a>인증 전까지는 몇몇 서비스를 사용 할 수 없습니다.
    </div>
    <div class="mb-3" th:if="${emailVerifiedChecked}">
        <div th:replace="theme-fragments.html :: red-notice(message=${emailVerifiedChecked})"></div>
    </div>
</div>

<div th:fragment="profile-settings-menu (currentMenu)" class="lg:w-1/3">
    <nav class="responsive-nav setting-nav setting-menu"
         uk-sticky="top:30 ; offset:80 ; media:@m ;bottom:true; animation: uk-animation-slide-top">
        <h4 class="mb-0 p-3 uk-visible@m hidden"> Setting Navigation </h4>
        <ul>
            <li class="" th:classappend="${currentMenu == 'profile'}? uk-active"><a href="#" th:href="@{/profile/settings/profile-settings}" class="hover:bg-gray-100"> <i class="uil-user"></i>소개</a></li>
            <li class="" th:classappend="${currentMenu == 'profile-img'}? uk-active" ><a href="#" th:href="@{/profile/settings/profile-img}" class="hover:bg-gray-100"> <i class="uil-scenery"></i>이미지 변경</a></li>
            <li class="" th:classappend="${currentMenu == 'tag'}? uk-active"><a href="#" th:href="@{/profile/settings/tags}" class="hover:bg-gray-100"> <i class="icon-material-outline-local-offer"></i> 태그</a></li>
            <li class="" th:classappend="${currentMenu == 'account'}? uk-active"><a href="#" th:href="@{/profile/settings/account}" class="hover:bg-gray-100"> <i class="icon-material-outline-person-pin"></i> 닉네임</a></li>
            <li class="" th:classappend="${currentMenu == 'alarm'}? uk-active"><a href="#" th:href="@{/profile/settings/alarm}" class="hover:bg-gray-100"> <i class="icon-material-baseline-notifications-none"></i> 알림</a></li>
            <li class="" th:classappend="${currentMenu == 'password'}? uk-active"><a href="#" th:href="@{/profile/settings/password}" class="hover:bg-gray-100"> <i class="uil-unlock-alt"></i> 패스워드 </a></li>
            <li class="" th:classappend="${currentMenu == 'withdraw'}? uk-active"><a href="#" th:href="@{/profile/settings/withdraw}" class="hover:bg-gray-100"> <i class="uil-trash-alt"></i> 회원탈퇴</a></li>
        </ul>
    </nav>
</div>

<div th:fragment="study-settings-menu (currentMenu)" class="lg:w-1/3">
    <nav class="responsive-nav setting-nav setting-menu"
         uk-sticky="top:30 ; offset:80 ; media:@m ;bottom:true; animation: uk-animation-slide-top">
        <h4 class="mb-0 p-3 uk-visible@m hidden"> Setting Navigation </h4>
        <ul>
            <li class="" th:classappend="${currentMenu == 'description'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/description'}" class="hover:bg-gray-100"> <i class="icon-material-outline-assignment"></i>소개</a></li>
            <li class="" th:classappend="${currentMenu == 'calendar'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/calendar'}" class="hover:bg-gray-100"> <i class="icon-feather-calendar"></i>일정</a></li>
            <li class="" th:classappend="${currentMenu == 'members'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/members'}" class="hover:bg-gray-100"> <i class="icon-material-outline-person-pin"></i>멤버</a></li>
            <li class="" th:classappend="${currentMenu == 'tag'}? uk-active" ><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/tags'}" class="hover:bg-gray-100"> <i class="icon-feather-tag"></i>스터디 주제</a></li>
            <li class="" th:classappend="${currentMenu == 'alarm'}? uk-active" ><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/alarm'}" class="hover:bg-gray-100"> <i class="icon-feather-bell"></i>스터디 알림</a></li>
            <li class="" th:classappend="${currentMenu == 'config'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/config'}" class="hover:bg-gray-100"> <i class="icon-material-outline-https"></i> 설정</a></li>
        </ul>
    </nav>
</div>

<div th:fragment="alarm-menu (currentMenu)" class="lg:w-1/3">
    <nav class="responsive-nav setting-nav setting-menu"
         uk-sticky="top:30 ; offset:80 ; media:@m ;bottom:true; animation: uk-animation-slide-top">
        <h4 class="mb-0 p-3 uk-visible@m hidden"> Setting Navigation </h4>
        <ul>
            <li class="" th:classappend="${currentMenu == 'description'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/description'}" class="hover:bg-gray-100"> <i class="icon-material-outline-assignment"></i>소개</a></li>
            <li class="" th:classappend="${currentMenu == 'calendar'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/calendar'}" class="hover:bg-gray-100"> <i class="icon-feather-calendar"></i>일정</a></li>
            <li class="" th:classappend="${currentMenu == 'tag'}? uk-active" ><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/tags'}" class="hover:bg-gray-100"> <i class="icon-feather-tag"></i>스터디 주제</a></li>
            <li class="" th:classappend="${currentMenu == 'alarm'}? uk-active" ><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/alarm'}" class="hover:bg-gray-100"> <i class="icon-feather-bell"></i>스터디 알림</a></li>
            <li class="" th:classappend="${currentMenu == 'config'}? uk-active"><a href="#" th:href="@{'/study/' + ${study.path} + '/settings/config'}" class="hover:bg-gray-100"> <i class="icon-material-outline-https"></i> 설정</a></li>
        </ul>
    </nav>
</div>

<script type="application/javascript" th:inline="" th:fragment="market-image">
    function readImage(input) {

        let maxSize = 5 * 1024 * 1024; //2MB
        let size = input.files[0].size;
        console.log(size);
        if(size > maxSize){
            alert("이미지 용량은 5MB 이내로 등록 가능합니다. ");
            return;
        }

        // 인풋 태그에 파일이 있는 경우
        if(input.files && input.files[0]) {
            // 이미지 파일인지 검사 (생략)
            let imageFile = $("#imageFile");
            imageFile.val("checked");
            console.log(imageFile);

            // FileReader 인스턴스 생성
            const reader = new FileReader()
            // 이미지가 로드가 된 경우
            reader.onload = e => {
                const previewImage = document.getElementById("preview-image")
                previewImage.src = e.target.result
            }
            // reader가 이미지 읽도록 하기
            reader.readAsDataURL(input.files[0])
        }
    }
    // input file에 change 이벤트 부여
    const inputImage = document.getElementById("input-image")
    inputImage.addEventListener("change", e => {
        readImage(e.target)
    })
</script>

<script type="application/javascript" th:fragment="form-validation">
    (function () {
        'use strict';

        window.addEventListener('load', function () {
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');

            // Loop over them and prevent submission
            Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated')
                }, false)
            })
        }, false)
    }())
</script>


<!-- 아래부터는 기존에 있던 fragments -->

<footer th:fragment="footer" class="page-footer font-small blue">
    <div class="footer-copyright text-center py-3">© 2022 Copyright:
        <a href="https://github.com/lee-ji-hoon/community">LeeJiHoon / KaJunYoung</a>
    </div>
</footer>


<script type="application/javascript" th:inline="javascript" th:fragment="ajax-csrf">
    $(function() {
        var csrfToken = [[${_csrf.token}]];
        var csrfHeader = [[${_csrf.headerName}]];
        $(document).ajaxSend(function (e, xhr, options) {
            xhr.setRequestHeader(csrfHeader, csrfToken);
        });
    });
</script>

<div th:fragment="profile-study-list(studyType)" class="relative">
    <div class="px-1 py-3">
        <div>
            <ul class="uk-child-width-1-4@m uk-child-width-1-3@s uk-grid-small uk-grid">
                <li th:each="study: ${studyType}">
                    <div class="card">
                        <div class="card-media h-28">
                            <div class="card-media-overly"></div>
                            <img th:src="${study.image}" th:alt="${study.title}" class="">
                        </div>
                        <div class="card-body">
                            <a th:href="@{'/study/' + ${study.path}}" class="font-semibold text-lg truncate" th:text="${study.title}"> Graphic Design </a>
                            <div class="flex items-center flex-wrap space-x-1 mt-3 text-xs text-gray-500 capitalize">
                                <div th:each="tag: ${study.tags}">
                                <span th:if="${tagStat.count} < 4" class="bg-gray-100 rounded-full
                                    font-weight-light text-monospace badge badge-pill badge-info mr-1 p-1">
                                    <a  class="text-decoration-none text-white">
                                        <i class="fa fa-tag"></i> <span class="" th:text="${tag.title}">Tag</span>
                                    </a>
                                </span>
                                </div>
                            </div>
                            <div class="flex mt-3.5 space-x-1">
                                <div th:each="manager : ${study.managers}" style="font-size: 14px">
                                    <strong th:text="${manager.nickname}">Johnson</strong>와
                                    <span th:text="${study.memberCount - 1} + '명이 참여'">5 freind are members</span>
                                </div>

                                <div class="flex -space-x-3 flex items-center" style="margin-top: -5px">
                                    <div th:each="manager : ${study.managers}">
                                        <div th:if="${managerStat.count} < 2">
                                            <img th:if="${#strings.isEmpty(manager?.profileImage)}"
                                                 th:data-id="${manager.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar"
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(manager?.profileImage)}"
                                                 th:src="${manager?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                    </div>
                                    <div th:each="member : ${study.members}">
                                        <div th:if="${memberStat.count} < 3">
                                            <img th:if="${#strings.isEmpty(member?.profileImage)}"
                                                 th:data-id="${member.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar "
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(member?.profileImage)}"
                                                 th:src="${member?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                        <div th:if="${memberStat.count} == 3">
                                            <div class="w-7 h-7 is_avatar rounded-full flex justify-center items-center bg-blue-100 text-blue-500 font-semibold"
                                                 th:text="${study.memberCount-3} + '+'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex mt-3.5 space-x-2 text-sm font-medium">
                                <a th:href="@{'/study/' + ${study.path}}"
                                   th:if="${!study.openStudy() && !study.endStudy()}"
                                   class="bg-blue-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    준비중
                                </a>

                                <a th:href="@{'/study/' + ${study.path}}"
                                   th:if="${study.openStudy()}"
                                   class="bg-green-500 w-full flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    진행중
                                </a>

                                <a th:href="@{'/study/' + ${study.path}}"
                                   th:if="${study.endStudy()}"
                                   class="bg-red-500 w-full fflex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    종료
                                </a>
                                <a th:href="@{'/study/' + ${study.path}}"
                                   class="bg-gray-200 flex flex-1 h-8 items-center justify-center rounded-md capitalize">
                                    자세히 보기
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<div th:fragment="study-info">
    <div class="row pt-4 text-left justify-content-center bg-light">
        <div class="col-6">
            <a href="#" class="text-decoration-none" th:href="@{'/study/' + ${study.path}}">
                <span class="h2" th:text="${study.title}">스터디 이름</span>
            </a>
        </div>
        <div class="col-4 text-right justify-content-end">
            <span th:if="${!study.recruiting}"
                  class="d-inline-block ml-1" tabindex="0" data-toggle="tooltip" data-placement="bottom" title="팀원 모집중 아님">
                    <button class="btn btn-primary btn-sm" style="pointer-events: none;" type="button" disabled>OFF</button>
            </span>
            <span sec:authorize="isAuthenticated()" th:if="${study.ƒisJoinable(#authentication.principal)}"
                  class="btn-group" role="group" aria-label="Basic example">
                <a class="btn btn-primary" th:href="@{'/study/' + ${study.path} + '/join'}">
                    스터디 가입
                </a>
                <a class="btn btn-outline-primary" th:href="@{'/study/' + ${study.path} + '/members'}"
                   th:text="${study.members.size()}">1</a>
            </span>
        </div>
    </div>
    <div class="row justify-content-center bg-light">
        <div class="col-10">
            <p class="lead" th:text="${study.shortDescription}"></p>
        </div>
    </div>
    <div class="row justify-content-center bg-light">
        <div class="col-10">
            <p>
                <span th:each="tag: ${study.tags}"
                      class="font-weight-light text-monospace badge badge-pill badge-info mr-3">
                    <a th:href="@{'/search/tag/' + ${tag.title}}" class="text-decoration-none text-white">
                        <i class="fa fa-tag"></i> <span th:text="${tag.title}">Tag</span>
                    </a>
                </span>
            </p>
        </div>
    </div>
</div>

<div id="create-post-modal" class="create-post" uk-modal th:fragment="board-write">
    <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical shadow-2xl uk-animation-slide-bottom-small">

        <div class="py-4 border-b flex  justify-between px-6">
            <h3 class="text-lg font-semibold"> 게시글 작성하기 </h3>
            <div>
                <div class="font-semibold px-2.5 py-1 bg-gray-100  rounded-md text text-gray-500 text-sm mr-8">
                    Saved as draft
                </div>
                <button class="uk-modal-close-default hover:bg-gray-100 rounded-full p-2.5 block uk-icon uk-close mt-0.5"
                        type="button" uk-close>
                    <i class="icon-feather-close"></i>
                </button>
            </div>
        </div>

        <form class="needs-validation space-y-4 g:w-8/12" id="board_form" action="/board/detail" th:action="@{/board/detail}" th:object="${boardForm}" method="post" novalidate>
            <div class="create-post-modal-body space-x-6 p-5 overflow-x-hidden mr-1" data-simplebar>
                <div class="space-y-4 g:w-8/12">

                    <div class="px-2 space-y-2">
                        <div class="font-semibold text-base"> 게시판 선택 </div>
                        <select class="selectpicker" th:field="*{boardTitle}">
                            <option data-icon="icon-material-outline-assignment" value="자유게시판" selected>자유게시판</option>
                            <option data-icon="icon-material-outline-access-alarm" value="신입생게시판">신입생게시판</option>
                            <option data-icon="icon-material-outline-account-circle" value="졸업생게시판">졸업생게시판</option>
                        </select>
                    </div>
                    <div class="font-semibold text-lg"> Details </div>
                    <div class="border focus-within:border-blue-300 p-3 pb-0 rounded-md form-group d-none">
                        <label for="writer" class="mb-0 ml-2 text-gray-600 text-sm">작성자</label>
                        <input type="hidden" placeholder="제목을 입력해주세요." id="writer"
                               th:value="${account.nickname}" name="writer" readonly
                               aria-describedby="writerHelp"
                               class="-mt-2 -mx-3 bg-transparent focus:bg-white focus:ring-gray-300 h-8 outline-none px-0 text-base w-full form-control">
                        <small id="writerHelp" class="form-text text-muted">
                            제목은 5글자부터 최대 30글자까지 입력 가능합니다.
                        </small>
                        <small class="invalid-feedback">제목을 입력해주세요.</small>
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('writer')}" th:errors="*{writer}">writer Error</small>
                    </div>
                    <div class="border focus-within:border-blue-300 p-3 pb-0 rounded-md form-group">
                        <label for="title" class="mb-0 ml-2 text-gray-600 text-sm">Title</label>
                        <input type="text" placeholder="제목을 입력해주세요." id="title"
                               th:field="*{title}" aria-describedby="titleHelp" required
                               class="-mt-2 -mx-3 bg-transparent focus:bg-white focus:ring-gray-300 h-8 outline-none px-0 text-base w-full form-control">
                        <small id="titleHelp" class="form-text text-muted">
                            제목은 5글자부터 최대 30글자까지 입력 가능합니다.
                        </small>
                        <small class="invalid-feedback">제목을 입력해주세요.</small>
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('title')}" th:errors="*{title}">title Error</small>
                    </div>
                    <div class="border focus-within:border-blue-300 p-3 rounded-md form-group">
                        <label for="content" class="mb-0 ml-2 text-gray-600 text-sm"> Description</label>
                        <textarea type="text" rows="5" placeholder="내용을 입력해주세요." id="content"
                                  th:field="*{content}" aria-describedby="contentHelp" required
                                  class="bg-transparent focus:bg-white focus:ring-gray-300 focus:shadow-none outline-none p-2 resize-none shadow-none text-base w-full form-control"></textarea>
                        <small id="contentHelp" class="form-text text-muted">남을 비방하는 글은 제제가 있을 수 있습니다.</small>
                        <small class="invalid-feedback">글을 입력해주세요.</small>
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('content')}" th:errors="*{content}">content Error</small>
                    </div>
                </div>

            </div>

            <div class="flex items-center w-full justify-between p-3 border-t">

                <div class="flex items-center space-x-2">

                    <ion-icon name="checkmark-circle" class="text-green-600 text-xl"></ion-icon>
                    <div> You are successfuly uploaded</div>

                </div>

                <div class="flex space-x-2">
                    <a href="#"
                       class="bg-red-100 flex font-medium h-9 items-center justify-center px-5 rounded-md text-red-600 text-sm">
                        <svg class="h-5 pr-1 rounded-full text-red-500 w-6 fill-current" id="veiw-more" fill="none"
                             stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="false"
                             style="">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z">
                            </path>
                        </svg>
                        Live </a>
                    <button type="submit"
                            id = "board_form_send"
                            class="bg-blue-600 flex h-9 items-center justify-center rounded-md text-white px-5 font-medium">
                        Share </button>
                </div>

                <button type="submit" hidden
                        id = "board_form_send"
                        class="bg-blue-600 flex h-9 items-center justify-center rounded-lg text-white px-12 font-semibold">
                    Share </button>
            </div>
        </form>

    </div>
</div>

<div th:fragment="editor-script">
    <script src="/node_modules/summernote/dist/summernote-bs4.js"></script>
    <script type="application/javascript">
        $(function () {
            $('#fullDescription').summernote({
                fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Noto Sans KR', 'Merriweather'],
                placeholder: '스터디의 목표, 일정, 진행 방식, 사용할 교재 또는 인터넷 강좌 그리고 모집중인 스터디원 등 스터디에 대해 자세히 적어 주세요.',
                tabsize: 2,
                height: 300
            });
        });
    </script>
</div>

<div th:fragment="message" th:if="${message}" class="alert alert-info alert-dismissible fade show mt-3" role="alert">
    <span th:text="${message}">완료</span>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div th:fragment="message_danger" th:if="${message_danger}" class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
    <span th:text="${message_danger}">완료</span>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>


<script th:fragment="tooltip" type="application/javascript">
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
</script>
<script src="/node_modules/@yaireo/tagify/dist/tagify.min.js"></script>
<script type="application/javascript" th:inline="javascript">
    $(function() {
        var studyPath = "[(${study.path})]";
        function tagRequest(url, tagTitle) {
            $.ajax({
                dataType: "json",
                autocomplete: {
                    enabled: true,
                    rightKey: true,
                },
                contentType: "application/json; charset=utf-8",
                method: "POST",
                url: "/study/" + studyPath + "/settings/tags" + url,
                data: JSON.stringify({'tagTitle': tagTitle})
            }).done(function (data, status) {
                console.log("${data} and status is ${status}");
            });
        }

        function onAdd(e) {
            tagRequest("/add", e.detail.data.value);
        }

        function onRemove(e) {
            tagRequest("/remove", e.detail.data.value);
        }

        var tagInput = document.querySelector("#tags");
        var tagify = new Tagify(tagInput, {
            pattern: /^.{0,20}$/,
            whitelist: JSON.parse(document.querySelector("#whitelist").textContent),
            dropdown : {
                enabled: 1, // suggest tags after a single character input
            } // map tags
        });
        tagify.on("add", onAdd);
        tagify.on("remove", onRemove);
        // add a class to Tagify's input element
        tagify.DOM.input.classList.add('form-control');
        // re-place Tagify's input element outside of the  element (tagify.DOM.scope), just before it
        tagify.DOM.scope.parentNode.insertBefore(tagify.DOM.input, tagify.DOM.scope);
    });
</script>

<div th:fragment="update-tags (baseUrl)">
    <script src="/node_modules/@yaireo/tagify/dist/tagify.min.js"></script>
    <script type="application/javascript" th:inline="javascript">
        $(function() {
            function tagRequest(url, tagTitle) {
                $.ajax({
                    dataType: "json",
                    autocomplete: {
                        enabled: true,
                        rightKey: true,
                    },
                    contentType: "application/json; charset=utf-8",
                    method: "POST",
                    url: "[(${baseUrl})]" + url,
                    data: JSON.stringify({'tagTitle': tagTitle})
                }).done(function (data, status) {
                    console.log("${data} and status is ${status}");
                });
            }

            function onAdd(e) {
                tagRequest("/add", e.detail.data.value);
            }

            function onRemove(e) {
                tagRequest("/remove", e.detail.data.value);
            }

            var tagInput = document.querySelector("#tags");
            var tagify = new Tagify(tagInput, {
                pattern: /^.{0,20}$/,
                tagList: JSON.parse(document.querySelector("#tagList").textContent),
                dropdown : {
                    enabled: 1, // suggest tags after a single character input
                } // map tags
            });
            tagify.on("add", onAdd);
            tagify.on("remove", onRemove);
            // add a class to Tagify's input element
            tagify.DOM.input.classList.add('form-control');
            // re-place Tagify's input element outside of the  element (tagify.DOM.scope), just before it
            tagify.DOM.scope.parentNode.insertBefore(tagify.DOM.input, tagify.DOM.scope);
        });
    </script>
</div>

<div th:fragment="bookmarkAjax">
    <script>
        $(document).on('click', '.bookmark_click', function() {
            // 해당 태그를 클릭하면 진행되는 메소드
            if($(this).children('svg').attr('id') == "bookmarkAddBtn"){
                // this는 클릭한 태그 전역
                // a 태그 하위에 있는 i 태그의 class가 fa fa-thumbs-up일 때
                $.ajax({
                    url:'/bookmark/add',
                    type:'get',
                    data : $('#bookmarkAdd').serialize(),
                    success : function (){
                        console.log("북마크 실행");
                        $('#blk_div').load(location.href+' #blk_div');
                    },
                });
            }else if($(this).children('svg').attr('id') == "bookmarkDelBtn"){
                $.ajax({
                    url:'/bookmark/delete',
                    type:'get',
                    data : $('#bookmarkCancel').serialize(),
                    success : function (){
                        console.log("북마크 취소");
                        $('#blk_div').load(location.href+' #blk_div');
                    },
                });
            }
        });
    </script>
</div>
<div th:fragment="bookmarkListDeleteAjax">
    <script>
        // 댓글 삭제
        let deleteBookmarkBtn = {
            deleteBookmark: function (postId, postSort) {
                swal({
                    title: "북마크를 제거하시겠습니까?",
                    text: "삭제된 북마크 내역은 복구할 수 없습니다.",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        window.addEventListener('keydown', function (e){
                            if (e.keyCode == 13) {
                                swal("엔터키는 사용할 수 없습니다.");
                            }
                        })
                        if (willDelete) {
                            $.ajax({
                                url:'/bookmark/delete',
                                type:'get',
                                data : (postSort === 'market') ? $(`#bookmarkCancelMarket${postId}`).serialize() :
                                    (postSort === 'board') ? $(`#bookmarkCancelBoard${postId}`).serialize() :
                                        (postSort === 'study') ? $(`#bookmarkCancelStudy${postId}`).serialize() :
                                            (postSort === 'council') ? $(`#bookmarkCancelCouncil${postId}`).serialize() : 0,
                                success : function (){
                                    console.log("북마크 취소");
                                    $('#blk_div').load(location.href+' #blk_div');
                                },
                            });
                            swal("북마크가 삭제되었습니다.", {
                                icon: "success",
                            });
                        } else {
                            swal("북마크가 삭제되지 않았습니다. 다시 시도해주세요.");
                        }
                    });
            }
        }
    </script>
</div>

<div th:fragment="likeAjax">
    <script>
        $(document).on('click', '.like_heart_click', function() {
            // .like_heart_click은 <a></a>태그의 class 이름
            // 해당 태그를 클릭하면 진행되는 메소드
            if($(this).children('svg').attr('class') == "likeAddBtn text-blue-500"){
                // this는 클릭한 태그 전역
                // a 태그 하위에 있는 i 태그의 class가 fa fa-thumbs-up일 때
                $.ajax({
                    url:'/like/add',
                    type:'get',
                    data : $('#like_add').serialize(),
                    success : function (){
                        $('#blk_div').load(location.href+' #blk_div');
                    },
                });
            }else if($(this).children('svg').attr('class') == "likeDelBtn text-red-500"){
                $.ajax({
                    url:'/like/delete',
                    type:'get',
                    data : $('#like_cancel').serialize(),
                    success : function (){
                        $('#blk_div').load(location.href+' #blk_div');
                    },
                });
            }
        });
    </script>
</div>
<div th:fragment="replyAjax">
    <script>
        var imageDelay = (function (){
            var timer = 0;
            return function (callback, ms) {
                clearTimeout(timer);
                timer = setTimeout(callback, ms);
            };
        })();
        let updateBtn = {
            replyUpdate: function (replyId) {
                jQuery(`#orginalReply${replyId}`).hide();
                jQuery(`#replyUpdateBtn${replyId}`).hide();
                jQuery(`#replyUpdateSubmit${replyId}`).show();
                $(`#replyUpdateInput${replyId}`).prop("type", "text");
                $(`#replyUpdateInput${replyId}`).css("background-color", "rgb(229 231 235)");
            }
        }
        let updateComplete = {
            replyUpdateAjax: function (replyId) {
                // 댓글 수정 ajax
                $.ajax({
                    url:'/reply/update',
                    type:'get',
                    data : $(`#replyUpdateForm${replyId}`).serialize(),
                    success : function (){
                        $('.reply_div').load(location.href+' .reply_div');
                        jQuery(`#orginalReply${replyId}`).show();
                        jQuery(`#replyUpdateBtn${replyId}`).show();
                        jQuery(`#replyUpdateSubmit${replyId}`).hide();
                        $(`#replyUpdateInput${replyId}`).prop("type", "hidden");
                    },
                });
                imageDelay(function (){
                    $(".identicon").each(function() {
                        var hash = md5($(this).data('id')).toString();
                        var data = new Identicon(hash,{format:'svg'}).toString();
                        $(this).attr('src', "data:image/svg+xml;base64,"+data);
                    });
                }, 1000);
            }
        }
        // 댓글 삭제
        let deleteReplyBtn = {
            deleteReply: function (replyId) {
                swal({
                    title: "댓글을 삭제하시겠습니까?",
                    text: "삭제된 댓글은 복구할 수 없습니다.",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        window.addEventListener('keydown', function (e){
                            if (e.keyCode == 13) {
                                swal("엔터키는 사용할 수 없습니다.");
                            }
                        })
                        if (willDelete) {
                            $.ajax({
                                url:'/reply/delete',
                                type:'get',
                                data : $(`#replyDeleteForm${replyId}`).serialize(),
                                success : function (){
                                    $('.reply_div').load(location.href+' .reply_div');
                                },
                            });
                            swal("댓글이 삭제되었습니다.", {
                                icon: "success",
                            });
                        } else {
                            swal("댓글이 삭제되지 않았습니다. 다시 시도해주세요.");
                        }
                        $('.reply_div').load(location.href+' .reply_div');
                        imageDelay(function (){
                            $(".identicon").each(function() {
                                var hash = md5($(this).data('id')).toString();
                                var data = new Identicon(hash,{format:'svg'}).toString();
                                $(this).attr('src', "data:image/svg+xml;base64,"+data);
                            });
                        }, 1000);
                    });
            }
        }
        $(document).ready(function (){
            // Delay 함수
            var delay = (function (){
                var timer = 0;
                return function (callback, ms) {
                    clearTimeout(timer);
                    timer = setTimeout(callback, ms);
                };
            })();
            // input에 있는 값을 가져옴
            var keydown = true;
            var input = document.getElementById("r_content");
            input.addEventListener('keypress', function(key){
                if (input.value == '' && key.key == 'Enter') {
                    swal("댓글을 입력해주세요.");
                }
                if(input.value != '' && key.key == 'Enter'){
                    $.ajax({
                        url:'/reply/add',
                        type:'get',
                        data : $('#reply_form').serialize(),
                        success : function (){
                            $('.reply_div').load(location.href+' .reply_div');
                            input.value ='';
                            keydown = false;
                            $(input).attr("readonly",true);
                            $(input).attr("placeholder","5초 뒤에 댓글을 입력할 수 있습니다.");
                        },
                    });
                }
                imageDelay(function (){
                    $(".identicon").each(function() {
                        var hash = md5($(this).data('id')).toString();
                        var data = new Identicon(hash,{format:'svg'}).toString();
                        $(this).attr('src', "data:image/svg+xml;base64,"+data);
                    });
                }, 1000);

                delay(function (){
                    $(input).removeAttr("readonly");
                    $(input).attr("placeholder","댓글을 입력해주세요.");
                    keydown=true;
                }, 5000);
            });
            $(document).on('click', '.write_reply', function() {
                if (input.value == '') {
                    swal("댓글을 입력해주세요.");
                }
                if (input.value != '') {
                    $.ajax({
                        url:'/reply/add',
                        type:'get',
                        data : $('#reply_form').serialize(),
                        success : function (){
                            $('.reply_div').load(location.href+' .reply_div');
                            input.value ='';
                            keydown = false;
                            $(input).attr("readonly",true);
                            $(input).attr("placeholder","5초 뒤에 댓글을 입력할 수 있습니다.");
                        },
                    });
                }
                imageDelay(function (){
                    $(".identicon").each(function() {
                        var hash = md5($(this).data('id')).toString();
                        var data = new Identicon(hash,{format:'svg'}).toString();
                        $(this).attr('src', "data:image/svg+xml;base64,"+data);
                    });
                }, 1000);

                delay(function (){
                    $(input).removeAttr("readonly");
                    $(input).attr("placeholder","댓글을 입력해주세요.");
                    keydown=true;
                }, 5000);
            });
        })
    </script>
</div>

<script th:fragment="studyBanner" type="application/javascript">
    function readImage(input) {

        let maxSize = 5 * 1024 * 1024; //5MB
        let size = input.files[0].size;
        console.log(size);
        if(size > maxSize){
            alert("이미지 용량은 5MB 이내로 등록 가능합니다. ");
            return;
        }

        // 인풋 태그에 파일이 있는 경우
        if(input.files && input.files[0]) {
            // 이미지 파일인지 검사 (생략)

            // FileReader 인스턴스 생성
            const reader = new FileReader()
            // 이미지가 로드가 된 경우
            reader.onload = e => {
                const previewImage = document.getElementById("preview-image")
                previewImage.src = e.target.result
            }
            // reader가 이미지 읽도록 하기
            reader.readAsDataURL(input.files[0])
        }
    }
    // input file에 change 이벤트 부여
    const inputImage = document.getElementById("study-image-file")
    inputImage.addEventListener("change", e => {
        readImage(e.target)
    })

    $(document).ready(function () {
        let $confirmBtn = $("#confirm-button");
        let $preview = $("#preview-image");
        let $current = $("#current-study-image");
        let $studyImageInput = $("#study-image-file");
        let $studyImageLabel = $("#study-image-file-label")

        $confirmBtn.hide();
        $preview.hide();

        $($studyImageInput).change(function (e) {
            $studyImageInput.hide();
            $current.hide();
            $studyImageLabel.hide();
            $studyImageInput.hide();
            $confirmBtn.show();
            $preview.show();
        });
    });
</script>

<div th:fragment="study-list (studyList)" class="col-sm-12">
    <div class="row">
        <div class="col-md-4" th:each="study: ${studyList}">
            <div class="card mb-4 shadow-sm">
                <img th:src="${study.image}" class="card-img-top" th:alt="${study.title}" >
                <div class="card-body">
                    <a th:href="@{'/study/' + ${study.path}}" class="text-decoration-none">
                        <h5 class="card-title context" th:text="${study.title}"></h5>
                    </a>
                    <p class="card-text" th:text="${study.shortDescription}">Short description</p>
                    <p class="card-text context">
                        <span th:each="tag: ${study.tags}" class="font-weight-light text-monospace badge badge-pill badge-info mr-3">
                            <a th:href="@{'/search/tag/' + ${tag.title}}" class="text-decoration-none text-white">
                                <i class="fa fa-tag"></i> <span th:text="${tag.title}">Tag</span>
                            </a>
                        </span>
                    </p>
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">
                            <i class="fa fa-user-circle"></i>
                            <span th:text="${study.memberCount}"></span>명
                        </small>
                        <small class="text-muted date" th:text="${study.publishedDateTime}">9 mins</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="study-menu (currentStudyMenu)" class="profile">
    <div id="current-study-image">
        <img class="rounded" th:src="${study.image}" width="100%" height="150px">
    </div>
    <img width="100%" height="150px"
         class="mt-3 content-center self-center"
         id="preview-image">

    <div class="profile_action absolute bottom-0 right-0 space-x-1.5 p-3 text-sm z-50 lg:flex">
        <div id="blk_div">
            <div class="flex-none w-5 mr-2 mt-1" id="bookmark_div">
                <div th:if="${bookmark.isEmpty()}">
                    <form id="bookmarkAdd">
                        <input type="hidden" id="postId" name="postId" th:value="${study.id}"/>
                        <input type="hidden" id="postSort" name="postSort" value="study"/>
                        <div uk-tooltip="북마크">
                            <a class="bookmark_click">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 48 48" id="bookmarkAddBtn" class="text-gray-500 font-bold" fill="currentColor">
                                    <path d="M34 6h-20c-2.21 0-3.98 1.79-3.98 4l-.02 32 14-6 14 6v-32c0-2.21-1.79-4-4-4zm0 30l-10-4.35-10 4.35v-26h20v26z"/>
                                </svg>
                            </a>
                        </div>
                    </form>
                </div>
                <div th:if="${bookmark.isPresent()}">
                    <form id="bookmarkCancel">
                        <div uk-tooltip="북마크 해제">
                            <input type="hidden" id="postId" name="postId" th:value="${study.id}"/>
                            <input type="hidden" id="postSort" name="postSort" value="study"/>
                            <a class="bookmark_click">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 48 48" id="bookmarkDelBtn" class="text-blue-500 font-bold" fill="currentColor">
                                    <path d="M34 6h-20c-2.21 0-3.98 1.79-3.98 4l-.02 32 14-6 14 6v-32c0-2.21-1.79-4-4-4zm0 30l-10-4.35-10 4.35v-26h20v26z"/>
                                </svg>
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <form id="imageForm" action="#" th:action="@{'/study/' + ${study.getPath()} + '/settings/banner'}"
              method="post" enctype="multipart/form-data" novalidate>
            <div class="custom-file" th:if="${study.isManager(#authentication.principal)}">
                <label for="study-image-file" id="study-image-file-label"
                       class="flex items-center justify-center h-8 px-3 rounded-md bg-gray-700 bg-opacity-70 text-white space-x-1.5">
                    <ion-icon name="create-outline" class="text-xl mr-1"></ion-icon>
                    배너 이미지 수정
                </label>
                <input type="file" name="file" id="study-image-file" accept="image/png, image/jpeg">
            </div>
            <button th:if="${study.isManager(#authentication.principal)}"
                    type="submit"
                    id="confirm-button"
                    class="flex items-center justify-center h-8 px-3 rounded-md bg-blue-600 bg-opacity-70 text-white space-x-1.5">
                확인
            </button>
        </form>


        <div th:if="${study.isJoinable(#authentication.principal)
                                && !study.isLimitMember()
                                || study.isMember(#authentication.principal)} ">
            <a th:if="${study.isJoinable(#authentication.principal)}"
               th:href="@{'/study/' + ${study.path} + '/join'}"
               href="#" class="flex items-center justify-center h-8 px-5 rounded-md bg-blue-600 text-white font-semibold space-x-1.5">
                <span> 참여 </span>
            </a>

            <a th:if="${study.recruiting() && study.isMember(#authentication.principal)}"
               th:href="@{'/study/' + ${study.path} + '/remove'}"
               href="#" class="flex items-center justify-center h-8 px-5 rounded-md bg-red-600 text-white font-semibold space-x-1.5">
                <span> 탈퇴 </span>
            </a>
        </div>
    </div>

    <div class="study_content">
        <div class="study_info">
            <h1 th:text="${study.title}"> Webinar - Raising ducks for egg production </h1>
            <div class="flex space-x-2 items-center md:pt-3 text-base -mt-2 md:justify-start justify-center">
                <div th:text="${study.shortDescription}"> Free</div>
            </div>
        </div>
        <div class="items-center space-x-2 text-center grid grid-cols-5 tooltip"
             th:if="${study.recruiting() && !study.isLimitMember()}"
             th:attrappend="uk-countdown = ${study.limitMemberDate}"
             uk-countdown="date: "><!--<b>모집 남은 시간 : </b>-->
            <div class="bg-gray-100 rounded-md p-2 ml-2 border shadow-inner">
                <span class="text-sm font-bold">모집 남은 기간 :  </span>
            </div>
            <div class="bg-gray-100 rounded-md p-2 ml-2 border shadow-inner">
                <span class="uk-countdown-days text-base font-bold"></span>
                <span class="font-bold">일 </span>
            </div>
            <div class="bg-gray-100 rounded-md p-2 border shadow-inner">
                <span class="uk-countdown-hours text-base font-bold"></span>
                <span class="font-bold">시 </span>
            </div>
            <div class="bg-gray-100 rounded-md p-2 border shadow-inner">
                <span class="uk-countdown-minutes text-base font-bold"></span>
                <span class="font-bold">분 </span>
            </div>
            <div class="bg-gray-100 rounded-md p-2 border shadow-inner">
                <span class=" uk-countdown-seconds text-base font-bold"></span>
                <span class="font-bold">초 </span>
            </div>
            <span class="tooltiptext tooltip-left">모집 남은 시간</span>
        </div>

        <div th:if="${!study.recruiting() || study.isLimitMember()}"
             class="items-center md:pt-3 text-base -mt-2 md:justify-start justify-center">
            <span class="text-lg font-bold text-danger"> 모집이 종료된 스터디입니다.</span>
        </div>

    </div>
    <div class="flex items-center space-x-4 lg:absolute bottom-0 right-0 p-3 z-10 justify-center">

    </div>
    <nav class="responsive-nav border-t -mb-0.5 lg:pl-2">
        <ul>
            <li th:classappend="${currentStudyMenu == 'view'}? active">
                <a th:href="@{'/study/' + ${study.path}}"> 소개</a></li>
            <li th:if="${study.isMember(#authentication.principal) || study.isManager(#authentication.principal)}"
                th:classappend="${currentStudyMenu == 'meeting' || currentStudyMenu == 'meetingView'}? active">
                <a th:href="@{'/study/' + ${study.path} + '/meetings'}">일정</a>
            </li>
            <li th:if="${study.isManager(#authentication.principal)}"
                th:classappend="${currentStudyMenu == 'settings'}? active">
                <a th:href="@{'/study/' + ${study.path} + '/settings/description'}">관리</a>
            </li>
        </ul>
    </nav>
</div>

<div th:fragment="blue-notice (message)" class="bg-blue-500 border p-4 relative rounded-md" uk-alert>
    <button class="uk-alert-close absolute bg-gray-100 bg-opacity-20 m-5 p-0.5 pb-0 right-0 rounded text-gray-200 text-xl top-0">
        <i class="icon-feather-x"></i>
    </button>
    <h3 class="text-lg font-semibold text-white">알림</h3>
    <p class="text-white text-opacity-75" th:text="${message}">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
</div>

<div th:fragment="red-notice (message)" class="bg-red-500 border p-4 relative rounded-md" uk-alert>
    <button class="uk-alert-close absolute bg-gray-100 bg-opacity-20 m-5 p-0.5 pb-0 right-0 rounded text-gray-200 text-xl top-0">
        <i class="icon-feather-x"></i>
    </button>
    <h3 class="text-lg font-semibold text-white">주의</h3>
    <p class="text-white text-opacity-75" th:text="${message}">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
</div>

<div th:fragment="gray-notice (message)" class="bg-green-500 border p-4 relative rounded-md" uk-alert>
    <button class="uk-alert-close absolute bg-gray-100 bg-opacity-20 m-5 p-0.5 pb-0 right-0 rounded text-gray-200 text-xl top-0">
        <i class="icon-feather-x"></i>
    </button>
    <h3 class="text-lg font-semibold text-white">정보</h3>
    <p class="text-white text-opacity-75" th:text="${message}">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
</div>

<div th:fragment="study-list-type (studyType)"
     class="relative" uk-slider="finite: true">
    <div class="uk-slider-container px-1 py-3">
        <div>
            <ul class="uk-slider-items uk-child-width-1-4@m uk-child-width-1-3@s uk-grid-small uk-grid">
                <li th:each="study: ${studyType}"
                    th:if="${study.limitStudyDate > now}">
                    <div class="card">
                        <div class="card-media h-28">
                            <div class="card-media-overly"></div>
                            <img th:src="${study.image}" th:alt="${study.title}" class="">
                        </div>
                        <div class="card-body">
                            <a th:href="@{'/study/' + ${study.path}}" class="font-semibold text-lg truncate" th:text="${study.title}"> Graphic Design </a>
                            <div class="flex items-center flex-wrap space-x-1 mt-3 text-xs text-gray-500 capitalize">
                                <div th:each="tag: ${study.tags}">
                                <span th:if="${tagStat.count} < 4" class="bg-gray-100 rounded-full
                                    font-weight-light text-monospace badge badge-pill badge-info mr-1 p-1">
                                    <a  class="text-decoration-none text-white">
                                        <i class="fa fa-tag"></i> <span class="" th:text="${tag.title}">Tag</span>
                                    </a>
                                </span>
                                </div>
                            </div>
                            <div class="flex mt-3.5 space-x-1">
                                <div th:each="manager : ${study.managers}" style="font-size: 14px">
                                    <strong th:text="${manager.nickname}">Johnson</strong>와
                                    <span th:text="${study.memberCount - 1} + '명이 참여'">5 freind are members</span>
                                </div>

                                <div class="flex -space-x-3 flex items-center" style="margin-top: -5px">
                                    <div th:each="manager : ${study.managers}">
                                        <div th:if="${managerStat.count} < 2">
                                            <img th:if="${#strings.isEmpty(manager?.profileImage)}"
                                                 th:data-id="${manager.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar"
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(manager?.profileImage)}"
                                                 th:src="${manager?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                    </div>
                                    <div th:each="member : ${study.members}">
                                        <div th:if="${memberStat.count} < 3">
                                            <img th:if="${#strings.isEmpty(member?.profileImage)}"
                                                 th:data-id="${member.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar "
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(member?.profileImage)}"
                                                 th:src="${member?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                        <div th:if="${memberStat.count} == 3">
                                            <div class="w-7 h-7 is_avatar rounded-full flex justify-center items-center bg-blue-100 text-blue-500 font-semibold"
                                                 th:text="${study.memberCount-3} + '+'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex mt-3.5 space-x-2 text-sm font-medium"
                                 th:if="${study.recruiting && !study.isLimitMember()}">
                                <a th:if="${study.isJoinable(#authentication.principal)}"
                                   th:href="@{'/study/' + ${study.path} + '/join'}"
                                   class="bg-blue-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    참가 신청
                                </a>
                                <span th:if="${!study.isJoinable(#authentication.principal)}"
                                      class="bg-green-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                        참여중
                                </span>
                                <a th:href="@{'/study/' + ${study.path}}"
                                   class="bg-gray-200 flex flex-1 h-8 items-center justify-center rounded-md capitalize">
                                    자세히 보기
                                </a>
                            </div>

                            <div class="flex mt-3.5 space-x-2 text-sm font-medium"
                                 th:if="${!study.recruiting || study.isLimitMember()}">
                                <span th:if="${!study.isManager(#authentication.principal) && !study.isMember(#authentication.principal)}"
                                      class="bg-red-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    인원 모집 마감
                                </span>

                                <span th:if="${study.isManager(#authentication.principal) || study.isMember(#authentication.principal)}"
                                      class="bg-green-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    참여 중
                                </span>
                                <a th:href="@{'/study/' + ${study.path}}"
                                   class="bg-gray-200 flex flex-1 h-8 items-center justify-center rounded-md capitalize">
                                    자세히 보기
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>

            <a class="absolute bg-white bottom-1/2 flex items-center justify-center p-2 -left-4 rounded-full shadow-md text-xl w-9 z-10 dark:bg-gray-800 dark:text-white" href="#" uk-slider-item="previous"> <i class="icon-feather-chevron-left"></i></a>
            <a class="absolute bg-white bottom-1/2 flex items-center justify-center p-2 -right-4 rounded-full shadow-md text-xl w-9 z-10 dark:bg-gray-800 dark:text-white" href="#" uk-slider-item="next"> <i class="icon-feather-chevron-right"></i></a>
        </div>
    </div>
</div>

<div th:fragment="study-list-type-not-contains (studyType)" class="relative">
    <div class="px-1 py-3">
        <div>
            <ul class="uk-child-width-1-4@m uk-child-width-1-3@s uk-grid-small uk-grid">
                <li th:each="study: ${studyType}"
                    th:if="${study.limitStudyDate > now}"
                    class="mt-3">
                    <div class="card">
                        <div class="card-media h-28">
                            <div class="card-media-overly"></div>
                            <img th:src="${study.image}" th:alt="${study.title}" class="">
                        </div>
                        <div class="card-body">
                            <a th:href="@{'/study/' + ${study.path}}" class="font-semibold text-lg truncate" th:text="${study.title}"> Graphic Design </a>
                            <div class="flex items-center flex-wrap space-x-1 mt-3 text-xs text-gray-500 capitalize">
                                <div th:each="tag: ${study.tags}">
                                <span th:if="${tagStat.count} < 4" class="bg-gray-100 rounded-full
                                    font-weight-light text-monospace badge badge-pill badge-info mr-1 p-1">
                                    <a  class="text-decoration-none text-white">
                                        <i class="fa fa-tag"></i> <span class="" th:text="${tag.title}">Tag</span>
                                    </a>
                                </span>
                                </div>
                            </div>
                            <div class="flex mt-3.5 space-x-1">
                                <div th:each="manager : ${study.managers}" style="font-size: 14px">
                                    <strong th:text="${manager.nickname}">Johnson</strong>와
                                    <span th:text="${study.memberCount - 1} + '명이 참여'">5 freind are members</span>
                                </div>

                                <div class="flex -space-x-3 flex items-center" style="margin-top: -5px">
                                    <div th:each="manager : ${study.managers}">
                                        <div th:if="${managerStat.count} < 2">
                                            <img th:if="${#strings.isEmpty(manager?.profileImage)}"
                                                 th:data-id="${manager.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar"
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(manager?.profileImage)}"
                                                 th:src="${manager?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                    </div>
                                    <div th:each="member : ${study.members}">
                                        <div th:if="${memberStat.count} < 3">
                                            <img th:if="${#strings.isEmpty(member?.profileImage)}"
                                                 th:data-id="${member.studentId}"
                                                 class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar "
                                                 style="height: 28px"/>
                                            <img th:if="${!#strings.isEmpty(member?.profileImage)}"
                                                 th:src="${member?.profileImage}"
                                                 class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                        </div>
                                        <div th:if="${memberStat.count} == 3">
                                            <div class="w-7 h-7 is_avatar rounded-full flex justify-center items-center bg-blue-100 text-blue-500 font-semibold"
                                                 th:text="${study.memberCount-3} + '+'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex mt-3.5 space-x-2 text-sm font-medium"
                                 th:if="${study.recruiting && !study.isLimitMember()}">
                                <a th:if="${study.isJoinable(#authentication.principal)}"
                                   th:href="@{'/study/' + ${study.path} + '/join'}"
                                   class="bg-blue-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    참가 신청
                                </a>
                                <a th:href="@{'/study/' + ${study.path}}"
                                   class="bg-gray-200 flex flex-1 h-8 items-center justify-center rounded-md capitalize">
                                    자세히 보기
                                </a>
                            </div>

                            <div class="flex mt-3.5 space-x-2 text-sm font-medium"
                                 th:if="${!study.recruiting || study.isLimitMember()}">
                                <span th:if="${!study.isManager(#authentication.principal) && !study.isMember(#authentication.principal)}"
                                      class="bg-red-500 flex flex-1 h-8 items-center justify-center rounded-md text-white capitalize">
                                    인원 모집 마감
                                </span>
                                <a th:href="@{'/study/' + ${study.path}}"
                                   class="bg-gray-200 flex flex-1 h-8 items-center justify-center rounded-md capitalize">
                                    자세히 보기
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>



<div th:fragment="study-acount-tag-list (tagList)">
    <div>
        <h2 class="text-xl font-semibold"> 나의 관심 태그 </h2>
        <p class="font-medium text-gray-500 leading-6 mt-2 mb-2"> 원하시는 태그를 클릭하시면 <br>해당하는 스터디가 조회됩니다. </p>
    </div>
    <div class="relative -mt-3 mb-2">
        <button th:each="tag: ${tagList.tags}"
                class="bg-gray-100 font-weight-light text-monospace mr-1 mt-3 p-1" >
            <span>#</span>
            <a th:href="@{'/study/search/'+${tag.title}}"
               th:text="${tag.title}">Tag</a>
        </button>
    </div>
</div>

<div th:fragment="study-tag-list (tagList)" class="relative -mt-3" >
    <div class=" px-1 py-3">
        <a th:href="@{/study}" class="bg-gray-100 font-weight-light text-monospace mr-1 mt-3 p-2" >
            <span>#</span>
            <span>전체보기</span>
        </a>
        <a th:each="tag: ${tagList}"
            th:href="@{'/study/search/'+${tag.title}}"
            class="bg-gray-100 font-weight-light text-monospace mr-1 mt-3 p-2" >
            <span>#</span>
            <span th:text="${tag.title}">Tag</span>
        </a>
    </div>
</div>

<div th:fragment="study-account-tag-list-empty">
    <h2 class="text-xl font-semibold"> 나의 관심 태그 </h2>
    <p class="font-medium text-gray-500 leading-6 mt-2 mb-2"> 등록중인 태그가 존재하지 않습니다.<br>
        <a href="#" class="text-blue-500" th:href="@{/profile/settings/tags}">태그 등록하기</a>
</div>



<div th:fragment="studyLists(type)">
    <div th:each="studyList : ${type}" >
        <div th:if="${studyList.limitStudyDate > now}" class="flex sm:flex-row flex-col sm:space-x-4 py-4 relative w-full">
            <div class="sm:w-56 w-full h-32 overflow-hidden rounded-lg relative shadow-sm flex-shrink-0">
                <img th:src="${studyList.image}" alt="" class="w-full h-full absolute inset-0 object-cover">
            </div>
            <div class="flex-1 relative md:mt-0 mt-4">
                <a th:text="${studyList.title}"
                   th:href="@{'/study/' + ${studyList.path}}"
                   class="text-xl font-semibold leading-6" >스터디 제목</a>
                <span th:if="${type == myStudy}" class="text-blue-500 font-bold ml-1">
                    매니저
                </span>
                <p class="leading-6 line-clamp-2 mt-2"
                   th:text="${studyList.shortDescription}"></p>
                <div class="flex mt-3.5 space-x-2">
                    <div th:each="manager : ${studyList.managers}" style="font-size: 14px">
                        <strong th:text="${manager.nickname}">Johnson</strong>와
                        <span th:text="${studyList.memberCount - 1} + '명이 참여'">5 freind are members</span>
                    </div>

                    <div class="flex -space-x-3 flex items-center" style="margin-top: -5px">
                        <div th:each="manager : ${studyList.managers}">
                            <div th:if="${managerStat.count} < 2">
                                <img th:if="${#strings.isEmpty(manager?.profileImage)}"
                                     th:data-id="${manager.studentId}"
                                     class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                <img th:if="${!#strings.isEmpty(manager?.profileImage)}"
                                     th:src="${manager?.profileImage}"
                                     class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                            </div>
                        </div>
                        <div th:each="member : ${studyList.members}">
                            <div th:if="${memberStat.count} < 3">
                                <img th:if="${#strings.isEmpty(member?.profileImage)}"
                                     th:data-id="${member.studentId}"
                                     class="identicon border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                                <img th:if="${!#strings.isEmpty(member?.profileImage)}"
                                     th:src="${member?.profileImage}"
                                     class="border-2 border-grey rounded-full w-7 h-7 is_avatar"/>
                            </div>
                            <div th:if="${memberStat.count} == 3">
                                <div class="w-7 h-7 is_avatar rounded-full flex justify-center items-center bg-blue-100 text-blue-500 font-semibold"
                                     th:text="${studyList.memberCount-3} + '+'">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:fragment="market-list(type)">
    <div th:each="sell : ${type}" class="flex items-start flex-wrap p-7 sm:space-x-6">
        <a th:href="@{'/market/detail/'+${sell.marketId}}" class="w-40 h-40 relative mt-1 order-1">
            <img th:if="${sell.getFilePath() != null}" th:src="${sell.getFilePath()}" alt="" class="rounded-md" style="width: 160px; height: 160px;">
        </a>
        <div class="flex-1 sm:order-2">
            <h4 class="text-base text-gray-500 font-medium mb-2" th:text="${sell.marketType}">Phaseout </h4>
            <a th:href="@{'/market/detail/'+${sell.marketId}}">
                <h3 class="text-xl font-medium mb-4" th:text="${sell.itemName}"> Technical Event Support Specialist </h3>
            </a>
            <div class="line-clamp-3" id="more-text" th:utext="${sell.itemDetail}">
            </div>
            <a th:href="@{'/market/detail/'+${sell.marketId}}"> 자세히 보기 </a>
        </div>
    </div>
</div>

<div th:fragment="alarm-list(type)" class="p-5">
    <ul class="list-group list-group-flush">
        <li class="card m-5 p-3" th:each="alarm : ${type}">
            <a th:href="@{'/alarm/detail/' + ${alarm.alarmId}}">
                <div class="d-flex w-100 justify-content-between">
                    <small class="text-left mb-0 text-lg font-semibold" th:text="${alarm.title}">title</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.MEETING_REPLY)}">모임 댓글</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.BOARD_REPLY)}">커뮤니티 댓글</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.MARKET_REPLY)}">장터 댓글</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.MEETING)}">모임 생성</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.STUDY)}">관심 스터디 생성</small>
                    <small class="fromNow text-muted" th:if="${alarm.alarmType.equals(alarm.alarmType.LIKES)}">좋아요</small>
                </div>
                <div class="d-flex w-100 justify-content-between">
                    <p class="text-left mb-0 mt-1" th:text="${alarm.message}">message</p>
                    <small class="mt-0 fromNow text-muted" th:text="${account.dateTime(alarm.createAlarmTime)}">3 days ago</small>
                </div>

            </a>
        </li>
    </ul>
</div>

<div th:fragment="profile-study-list(studyType)" th:each="study: ${studyType}" class="card p-2">
    <a th:href="@{'/study/' + ${study.path}}">
        <img th:src="${study.image}"
             th:alt="${study.title}"
             class="h-28 object-cover rounded-md shadow-sm w-full">
    </a>
    <div class="pt-3 px-1">
        <a th:href="@{'/study/' + ${study.path}}"
           th:text="${study.title}"
           class="text-base font-semibold mb-0.5">  James Lewis </a>
        <div class="flex items-center flex-wrap space-x-1 mt-1 mb-2 text-xs text-gray-500 capitalize h-4">
            <div th:each="tag: ${study.tags}">
                <span th:if="${tagStat.count} < 4" class="bg-gray-100 rounded-full
                    font-weight-light text-monospace badge badge-pill badge-info mr-1 p-1">
                    <a  class="text-decoration-none text-white">
                        <i class="fa fa-tag"></i> <span class="" th:text="${tag.title}">Tag</span>
                    </a>
                </span>
            </div>
        </div>
        <div class="flex mt-3.5 space-x-1">
            <div th:each="manager : ${study.managers}" style="font-size: 14px">
                <strong th:text="${manager.nickname}">Johnson</strong>와
                <span th:text="${study.memberCount - 1} + '명이 참여'">5 freind are members</span>
            </div>

            <div class="flex -space-x-3 flex items-center" style="margin-top: -5px">
                <div th:each="manager : ${study.managers}">
                    <div th:if="${managerStat.count} < 2">
                        <img th:if="${#strings.isEmpty(manager?.profileImage)}"
                             th:data-id="${manager.studentId}"
                             class="identicon border-2 border-grey rounded-full w-7 is_avatar"/>
                        <img th:if="${!#strings.isEmpty(manager?.profileImage)}"
                             th:src="${manager?.profileImage}"
                             class="border-2 border-grey rounded-full w-7 is_avatar"/>
                    </div>
                </div>
                <div th:each="member : ${study.members}">
                    <div th:if="${memberStat.count} < 3">
                        <img th:if="${#strings.isEmpty(member?.profileImage)}"
                             th:data-id="${member.studentId}"
                             class="identicon border-2 border-grey rounded-full w-7 is_avatar ">
                        <img th:if="${!#strings.isEmpty(member?.profileImage)}"
                             th:src="${member?.profileImage}"
                             class="border-2 border-grey rounded-full w-7 is_avatar"/>
                    </div>
                    <div th:if="${memberStat.count} == 3">
                        <div class="w-7 h-7 is_avatar rounded-full flex justify-center items-center bg-blue-100 text-blue-500 font-semibold"
                             th:text="${study.memberCount-3} + '+'">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <a th:href="@{'/study/' + ${study.path}}"
           th:if="${!study.openStudy() && !study.endStudy()}"
           class="bg-gray-500 w-full flex font-semibold h-8 items-center justify-center mt-3 px-3 rounded-md text-white text-sm mb-1">
            준비중
        </a>

        <a th:href="@{'/study/' + ${study.path}}"
           th:if="${study.openStudy()}"
           class="bg-blue-500 w-full flex font-semibold h-8 items-center justify-center mt-3 px-3 rounded-md text-white text-sm mb-1">
            진행중
        </a>

        <a th:href="@{'/study/' + ${study.path}}"
           th:if="${study.endStudy()}"
           class="bg-red-500 w-full flex font-semibold h-8 items-center justify-center mt-3 px-3 rounded-md text-white text-sm mb-1">
            종료
        </a>
    </div>
</div>


<ul th:fragment="profile-open-study-list(studyList)" role="list" class="p-3 divide-y divide-slate-200">
    <li th:each="study: ${studyList}"
        th:if="${study.isManager(#authentication.principal) || study.isMember(#authentication.principal)}"
        class="flex py-4 first:pt-0 last:pb-0">
        <a th:href="@{'/study/' + ${study.path}}">
            <img th:src="${study.image}"
                 th:alt="${study.title}"
                 class="full-width"
                 style="height: 55px; width: 125px">
        </a>
        <div class="ml-3 overflow-hidden">
            <a th:href="@{'/study/' + ${study.path}}">
                <p th:text="${study.title}"
                   class="text-sm font-medium text-slate-900" >{person.name}</p>
                <p th:text="${study.shortDescription}"
                   class="text-sm text-slate-500 truncate">{person.bio}</p>
            </a>
        </div>
    </li>
</ul>

<div th:fragment="market-paging(marketType, link)">
    <div class="divide-y divide-gray-100 sm:m-0 -mx-4">
        <div th:each="market : ${marketType.getContent()}"
             class="flex items-start card flex-wrap p-2 my-5 sm:space-x-6">
            <a th:href="@{'/market/detail/'+${market.marketId}}" class="w-40 h-40 relative mt-1 order-1">
                <img th:if="${market.getFilePath() != null}" th:src="${market.getFilePath()}" alt="" class="rounded-md" style="width: 160px; height: 160px;">
            </a>
            <div class="flex-1 sm:order-2 mt-4">
                <h4 class="text-base text-gray-500 font-medium mb-2" th:if="${market.marketType == 'sell'}">판매 </h4>
                <h4 class="text-base text-gray-500 font-medium mb-2" th:if="${market.marketType == 'buy'}">구매 </h4>
                <h4 class="text-base text-gray-500 font-medium mb-2" th:if="${market.marketType == 'share'}">나눔 </h4>
                <a th:href="@{'/market/detail/'+${market.marketId}}">
                    <h3 class="text-xl font-medium mb-4" th:text="${market.itemName}"> Technical Event Support Specialist </h3>
                </a>
                <div class="line-clamp-3" id="more-text" th:utext="${market.itemDetail}">
                </div>
                <a th:href="@{'/market/detail/'+${market.marketId}}"> 자세히 보기 </a>
            </div>
        </div>

        <div th:if="${marketType.totalPages != 0}">
            <nav aria-label="Page navigation "
                 th:with="start=${(marketType.number/5)*5 + 1},
                                        end=(${(marketType.totalPages == 0) ? 1 :
                                        (start + 4 < marketType.totalPages ? start + 4 : marketType.totalPages)})">

                <ul class="space-x-2 justify-center flex mt-5">

                    <!--
                    * < 꺽새 그려줌
                    -->
                    <li th:if="${start > 1}">
                        <a th:href="@{${link}(page=${start - 2})}">
                            <button class="font-bold flex items-center justify-center w-10 h-10 text-indigo-600 transition-colors duration-150 rounded-full focus:shadow-outline hover:bg-indigo-100">
                                <svg class="w-4 h-4 fill-current " viewBox="0 0 20 20">
                                    <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                                          clip-rule="evenodd" fill-rule="evenodd"></path>
                                </svg>
                            </button>
                        </a>
                    </li>
                    <!--
                    * 페이지를 뿌려주는 부분
                    -->
                    <li th:each="page : ${#numbers.sequence(start, end)}">
                        <a th:href="@{${link}(page=${page - 1})}">
                            <button th:classappend="${page == pageNo + 1} ? 'text-white bg-indigo-600' : 'text-indigo-600'"
                                    class="w-10 h-10 font-bold transition-colors duration-150 rounded-full focus:shadow-outline hover:bg-indigo-100"
                                    th:text="${page}">
                            </button>
                        </a>
                    </li>
                    <!--
                    * > 꺽새 그려줌
                    -->
                    <li th:if="${end < marketType.totalPages}">
                        <a th:href="@{${link}(page=${start + 4})}">
                            <button class="font-bold flex items-center justify-center w-10 h-10 text-indigo-600 transition-colors duration-150 bg-white rounded-full focus:shadow-outline hover:bg-indigo-100">
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20">
                                    <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                          clip-rule="evenodd" fill-rule="evenodd"></path>
                                </svg>
                            </button>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<footer th:fragment="summernote-ko-kr">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
    <script src="/assets/js/summernote-ko-KR.js"></script>
    <script src="/assets/css/summernote.min.css"></script>
    <script src="/assets/js/summernote.min.js"></script>
</footer>
<script th:fragment="graduation-note-tag">
    let memberArray = [];
    $(document).ready(function() {
        //여기 아래 부분
        $('#description').summernote({
            height: 300,                 // 에디터 높이
            minHeight: null,             // 최소 높이
            maxHeight: null,             // 최대 높이
            lang: "ko-KR",					// 한글 설정
            placeholder: '졸업작품에 관련해서 최대한 자세히 작성해주세요.', //placeholder 설정
            toolbar: [
                ['font', ['bold', 'italic', 'underline', 'clear']],
            ],
        });

        $(".keywords-container").each(function() {
            // 키워드 시작
            const keywordInput = $(this).find(".keyword-input");
            const keywordsList = $(this).find(".keywords-list");
            // 태그 추가
            function addKeyword() {
                var $newKeyword = $("" +
                    "<span class='keyword'>" +
                    "<span class='keyword-remove'></span>" +
                    `<span class='keyword-text' value=${keywordInput.val()}>${keywordInput.val()}</span>` +
                    "</span>");
                keywordsList.append($newKeyword).trigger('resizeContainer');
                memberArray.push(keywordInput.val());
                console.log(memberArray);
                keywordInput.val("");
            }

            // 태그 추가 엔터
            keywordInput.on('keyup', function(e){
                if((e.keyCode == 13) && (keywordInput.val()!=="")){
                    addKeyword();
                }
            });

            // 태그 추가 버튼
            $('.keyword-input-button').on('click', function(){
                if((keywordInput.val()!=="")){
                    addKeyword();
                }
            });

            // 태그 지우기
            $(document).on("click",".keyword-remove", function(){
                $(this).parent().addClass('keyword-removed');

                function removeFromMarkup(){
                    let value = $(".keyword-removed").remove().text();
                    memberArray = memberArray.filter(function(item) {
                        return item !== value;
                    });
                }
                setTimeout(removeFromMarkup, 500);
                keywordsList.css({'height':'auto'}).height();
            });

            keywordsList.on('resizeContainer', function(){
                var heightnow = $(this).height();
                var heightfull = $(this).css({'max-height':'auto', 'height':'auto'}).height();

                $(this).css({ 'height' : heightnow }).animate({ 'height': heightfull }, 200);
            });

            $(window).on('resize', function() {
                keywordsList.css({'height':'auto'}).height();
            });

            $(window).on('load', function() {
                var keywordCount = $('.keywords-list').children("span").length;

                if (keywordCount > 0) {
                    keywordsList.css({'height':'auto'}).height();

                }
            });
            // 키워드 끝
        });

    });
</script>
<script th:fragment="s3-imge-upload(uploadUrl)">
    $(document).ready(function () {
        $("#input_file").on("change", fileCheck);
    });
    $(function () {
        $('#btn-upload').click(function (e) {
            e.preventDefault();
            $('#input_file').click();
        });
    });

    // 파일 현재 필드 숫자 totalCount랑 비교값
    let fileCount = 0;
    // 해당 숫자를 수정하여 전체 업로드 갯수를 정한다.
    const totalCount = 6;
    // 파일 고유넘버
    let fileNum = 0;
    // 첨부파일 배열
    const content_files = new Array();
    // 이미지
    let imageFileDict = {};

    function fileCheck(e) {

        const files = e.target.files;

        // 파일 배열 담기
        const filesArr = Array.prototype.slice.call(files);

        if (fileCount + filesArr.length > totalCount) {
            alert('이미지는 최대 '+totalCount+'개까지 업로드 할 수 있습니다.');
            return;
        } else {
            fileCount = fileCount + filesArr.length;
        }

        // 각각의 파일 배열담기 및 기타
        filesArr.forEach(function (f) {
            const reader = new FileReader();
            reader.onload = function (e) {
                imageFileDict[fileNum] = files;
                content_files.push(f);
                $('#articlefileChange').append(
                    '<div class="mx-1" id="file' + fileNum + '" onclick="fileDelete(\'file' + fileNum + '\')">' +
                    '<button> 삭제 </button>' +
                    `<img src="${e.target.result}" data-file=${f.name} className="article-image" style="width: 150px; height: 200px"/>` +
                    '</div>'
                );
                fileNum ++;
            };
            reader.readAsDataURL(f);
        });
        //초기화 한다.
        $("#input_file").val("");
    }

    // 파일 부분 삭제 함수
    function fileDelete(fileNum){
        var no = fileNum.replace(/[^0-9]/g, "");
        content_files[no].is_delete = true;
        $('#' + fileNum).remove();
        fileCount --;
    }

    document.graduationForm.addEventListener("keydown", evt => {
        if (evt.code === "Enter") evt.preventDefault();
    });
    document.imageDelete.addEventListener("keydown", evt => {
        if (evt.code === "Enter") evt.preventDefault();
    });

    function updateProject(e) {
        const form = $("form")[0];
        const formData = new FormData(form);

        if (memberArray.length > 4) {
            alert("인원은 4명까지만 등록 가능합니다.");
            return;
        }

        if (memberArray.length === 0) {
            alert("본인 포함 팀장과 팀원들을 적어주시기 바랍니다.")
            return;
        }

        formData.append("teamMember", memberArray);
        formData.append("title", $('#title').val());
        formData.append("teamName", $('#teamName').val());
        formData.append("path", $('#path').val());
        formData.append("graduationType", $('#graduationType').val());
        formData.append("graduationDate", $("#graduationDate").val())
        formData.append("description", $('#description').val());


        // TODO 이미지 1개도 없을 때 생각해야함

        for (let x = 0; x < content_files.length; x++) {
            // 삭제 안한것만 담아 준다.
            if (!content_files[x].is_delete) {
                formData.append("article_file", content_files[x]);
            }
        }
        /*
        * 파일업로드 multiple ajax처리
        */
        $.ajax({
            type: "POST",
            enctype: "multipart/form-data",
            url: "[(${uploadUrl})]",
            processData: false,
            contentType: false,
            data: formData,
            success: function () {
                location.reload();
            },
            error: function (xhr, status, error) {
                alert("작성한 내용들을 다시 확인해주세요.")
            }
        });
        return false;
    }

    function registerAction(e) {

        const form = $("form")[0];
        const formData = new FormData(form);

        if (memberArray.length > 4) {
            alert("인원은 4명까지만 등록 가능합니다.");
            return;
        }

        if (memberArray.length === 0) {
            alert("본인 포함 팀장과 팀원들을 적어주시기 바랍니다.")
            return;
        }

        formData.append("teamMember", memberArray);
        formData.append("title", $('#title').val());
        formData.append("teamName", $('#teamName').val());
        formData.append("path", $('#path').val());
        formData.append("graduationType", $('#graduationType').val());
        formData.append("graduationDate", $("#graduationDate").val())
        formData.append("description", $('#description').val());

        if (content_files.length === 0 && $('#imageName').val() == null) {
            alert('이미지는 최소 1개 이상 업로드해야 합니다.');
            return;
        }

        for (let x = 0; x < content_files.length; x++) {
            // 삭제 안한것만 담아 준다.
            if (!content_files[x].is_delete) {
                formData.append("article_file", content_files[x]);
            }
        }
        /*
        * 파일업로드 multiple ajax처리
        */
        $.ajax({
            type: "POST",
            enctype: "multipart/form-data",
            url: "[(${uploadUrl})]",
            processData: false,
            contentType: false,
            data: formData,
            success: function (path) {
                location.href = "/graduation/" + path;
            },
            error: function (xhr, status, error) {
                alert("작성한 내용들을 다시 확인해주세요." + error)
            }
        });
        return false;
    }
</script>


<span th:fragment="projectTypeBadge(projectType)"
        th:classappend="${projectType == 'WEB'}? 'bg-blue-700' :
                      (${projectType == 'MOBILE'}? 'bg-green-700' :
                      (${projectType == 'VIDEO'}? 'bg-yellow-700' :
                      (${projectType == 'VR_AR'}? 'bg-indigo-700' :
                      'bg-purple-700')))"
      class="rounded-full font-weight-light text-monospace
             badge badge-pill badge-info mr-1 px-2">
    <span class="text-white">
        <i class="fa fa-tag"></i>
        <a class="text-sm"
           th:href="@{'/graduation/search-keyword/'+${projectType}}"
           th:text="${projectType}"></a>
    </span>
</span>

</html>
